<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="//code.jquery.com/jquery-3.3.1.js"></script>
    <title>Document</title>
</head>
<body>
    <div id="div"><input type="text" class="input"><br></div>
    <button id="btnAdd">추가</button>
    <button id="btnOk">확인</button>
    <script>
        $('#btnAdd').click(function(){
            // 첫번째 방법
            // div태그를 이용해도 되지만 div태그가 다수일경우 원하지 않은 동작이 될 수 있다.
            // var input = '<input type="text"><br>'
            // $('#div').append(input);
            
            // // 두번째 방법
            // $(this).parent().find('#div').append(input);

            // 세번째 방법
            var input2= '<br><input type="text" class="input">';
            $('.input').last().after(input2);
            $('.input').last().focus();
        });

        $('#btnOk').click(function(){
            var data = new String(); // 문자열을 이용하여 처리
            var data2 = []; // 배열 이용
            $('.input').each(function(){
                var tmpData = $(this).val();
                if(tmpData != "") {
                    data += ',' + tmpData;
                    data2.push(tmpData);
                }
            });
                // 첫번째 데이터에 ,를 빼기 위한 작업.
                data = data.substr(1);

                $(opener.document).find('#fruit').val(data);
                //opener.document.getElementsById('fruit').value=data;
                //opener.document.getElementsByClassName('fruit')[0].value=data;

                // 배열을 이용하여 처리
                // join(구분자) : 배열의 각 원소들을 문자열로 바꾸는데 원소들 사이에 구분자를 입력.
                //$(opener.document).find('#fruit').val(data2.join(','));
                opener.$('#fruit').trigger('change');
                //setTimeout(function(){window.close()},1000);
        });
    </script>
</body>
</html>